<div class="row" id="manage" style="margin-bottom:100px;">
  <div class="col-md-12">
    <div class="panel panel-default">
      <div class="panel-heading">
        <div class="btn-group pull-right" style="height: 38px;margin-top:-8px;background-color: #ffffff; border-left: 1px solid #dddddd;border-top: 1px solid #dddddd;border-right: 1px solid #dddddd;border-bottom: 1px solid #ffffff;">
          <span class="btn btn-sm dropdown-toggle" data-toggle="dropdown">
            <i class="fa fa-calendar"></i><span class="hidden-xs"> Periode Rawat Jalan</span>
          </span>
          <ul class="dropdown-menu dropdown-menu-right">
            <li style="padding-left:5px;padding-right:5px;">
              <input type="text" id="periode_rawat_jalan" class="form-control periode_rawat_jalan" name="periode_rawat_jalan" required>
            </li>
            <li style="padding-left:5px;padding-right:5px;margin-top:5px;">
              <input type="text" id="periode_rawat_jalan_akhir" class="form-control periode_rawat_jalan" name="periode_rawat_jalan_akhir" required>
            </li>
            <li style="padding-left:5px;padding-right:5px;margin-top:5px;">
              <div id="submit_periode_rawat_jalan" class="btn btn-primary btn-block" style="text-align: left !important;">Semua</div>
            </li>
            <li style="padding-left:5px;padding-right:5px;margin-top:5px;">
              <div id="belum_periode_rawat_jalan" class="btn btn-primary btn-block" style="text-align: left !important;">Belum Diperiksa</div>
            </li>
            <li style="padding-left:5px;padding-right:5px;margin-top:5px;">
              <div id="selesai_periode_rawat_jalan" class="btn btn-primary btn-block" style="text-align: left !important;">Selesai Diperiksa</div>
            </li>
            <li style="padding-left:5px;padding-right:5px;margin-top:5px;">
              <div id="lunas_periode_rawat_jalan" class="btn btn-primary btn-block" style="text-align: left !important;">Sudah Bayar</div>
            </li>
          </ul>
        </div>
        <h3 class="panel-title">Kelola Pasien</h3>
      </div>
      <div class="panel-body">
        <div class="row">
          <div id="notif"></div>
        </div>
        <div id="dokter_ralan" class="display">
          {include: ../plugins/dokter_ralan/view/admin/display.html}
        </div>
        <div class="row">
          {include: ../plugins/dokter_ralan/view/admin/form.rincian.html}
          {include: ../plugins/dokter_ralan/view/admin/form.soap.html}
          {include: ../plugins/dokter_ralan/view/admin/form.kontrol.html}
        </div>
        <div>
          <div id="rincian"></div>
          <div id="soap"></div>
          <div id="surat_kontrol"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<style>
.modal-fullscreen {
    width: calc(100% - 80px);
    height: calc(100% - 80px);
    margin: 40px;
}

.modal-fullscreen .modal-content {
    height: 100%;
    border-radius: 8px; /* opsional biar lebih halus */
}

.modal-fullscreen .modal-body {
    height: calc(100% - 120px);
    padding: 0;
}
/* Header */
#pdfModal .modal-header {
    background-color: #f5f7fa;       /* abu-abu lembut */
    border-bottom: 1px solid #ddd;
    padding: 15px 20px;
}

/* Footer */
#pdfModal .modal-footer {
    background-color: #f5f7fa;       /* samakan dengan header */
    border-top: 1px solid #ddd;
    padding: 15px 20px;
}

/* Judul */
#pdfModal .modal-title {
    font-weight: 600;
}

/* Supaya iframe tidak ketutup */
#pdfModal .modal-body {
    background-color: #fff;
}
</style>
<div class="modal fade" id="pdfModal" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-fullscreen" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Riwayat Perawatan Pasien</h4>
      </div>
      <div class="modal-body">
        <iframe
          id="pdfFrame"
          style="width:100%; height:100%; border:none;"
        ></iframe>
      </div>
      <div class="modal-footer">
        <form id="tteForm" method="post" action="{?=url([ADMIN,'sertisign','signingqrerm'])?}">
          <input type="hidden" name="no_rkm_medis" id="no_rkm_medis_2">
          <input type="hidden" name="no_rawat" id="no_rawat">
          <input type="hidden" name="signer" id="signer">
          <input type="hidden" name="w" id="w">
          <input type="hidden" name="h" id="h">
          <input type="hidden" name="flagging" id="flagging">

          <button type="submit" class="btn btn-success">
            <i class="glyphicon glyphicon-qrcode"></i>
            Kirim TTE Sertisign
          </button>

          <button type="button" class="btn btn-default" data-dismiss="modal">
            Tutup
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
<script>
function openPdfTteModal(no_rkm_medis, no_rawat) {
    var pdfUrl =
        '{?=url()?}/{?=ADMIN?}/pasien/pdfriwayatperawatan/'
        + no_rkm_medis + '/'
        + no_rawat.replace(/\//g, '') +
        '?t={$_SESSION["token"]}';

    // Load PDF
    $('#pdfFrame').attr('src', pdfUrl);

    // Set hidden form values
    $('#no_rkm_medis_2').val(no_rkm_medis);
    $('#no_rawat').val(no_rawat);

    // signer (JSON string)
    $('#signer').val(JSON.stringify([
      {
        identifier: "sertisign-poa2-snbx@yopmail.com",
        keyword: "#1A",
        qrValue: "TTE oleh sertisign-poa2-snbx@yopmail.com",
        pin: "1234"
      }
    ]));

    // parameter terpisah
    $('#w').val('40');
    $('#h').val('40');

    // flagging (JSON string)
    $('#flagging').val(JSON.stringify([
      {
        flag1: "Dokumen Rekam Medis Pasien A"
      }
    ]));

    $('#pdfModal').modal({
        backdrop: 'static',
        keyboard: false
    });
}

// clear iframe on close
$('#pdfModal').on('hidden.bs.modal', function () {
    $('#pdfFrame').attr('src', '');
});
</script>
<script type="text/javascript">
   $(function () {
       $('.periode_rawat_jalan').datetimepicker({
         defaultDate: '{?=date('Y-m-d')?}',
         format: 'YYYY-MM-DD',
         locale: 'id'
       });
   });
</script>
